function mdjm_validate_payment_form(){var a=jQuery('input[type="radio"][name="mdjm_payment_amount"]:checked');if(0===a.length)return{msg:mdjm_vars.no_payment_amount};if("part_payment"===a.val()){var b=jQuery("#part-payment").val();if(!jQuery.isNumeric(b))return{type:"error",field:"part-payment",msg:mdjm_vars.no_payment_amount}}return{type:"success"}}function mdjm_load_gateway(a){jQuery(".mdjm-payment-ajax").show(),jQuery("#mdjm_payment_form_wrap").html('<img src="'+mdjm_vars.ajax_loader+'"/>');var b=mdjm_vars.ajaxurl;b+=b.indexOf("?")>0?"&":"?",b=b+"payment-mode="+a,jQuery.post(b,{action:"mdjm_load_gateway",mdjm_payment_mode:a},function(a){jQuery("#mdjm_payment_form_wrap").html(a),jQuery(".mdjm-no-js").hide(),jQuery(".mdjm-payment-ajax").hide()})}var mdjm_vars;jQuery(document).ready(function(a){a("select#mdjm-gateway, input.mdjm-gateway").change(function(){var b=a("#mdjm-gateway option:selected, input.mdjm-gateway:checked").val();return"0"!==b&&(mdjm_load_gateway(b),!1)}),"1"===mdjm_vars.is_payment&&a("select#mdjm-gateway, input.mdjm-gateway").length&&setTimeout(function(){mdjm_load_gateway(mdjm_vars.default_gateway)},200),a(document.body).on("click","#mdjm-payment-part",function(){a("#mdjm-payment-custom").show("fast")}),a(document.body).on("click","#mdjm-payment-deposit, #mdjm-payment-balance",function(){a("#mdjm-payment-custom").hide("fast")}),a(document).on("click","#mdjm_payment_form #mdjm_payment_submit input[type=submit]",function(b){var c=document.getElementById("mdjm_payment_form");if("function"!=typeof c.checkValidity||!1!==c.checkValidity()){b.preventDefault(),a(this).val(mdjm_vars.payment_loading),a(this).prop("disabled",!0),a(this).after('<span class="mdjm-payment-ajax"><i class="mdjm-icon-spinner mdjm-icon-spin"></i></span>');var d=mdjm_validate_payment_form(c);"success"===d.type?(a(c).find(".mdjm-alert").hide("fast"),a(c).find(".error").removeClass("error"),a(c).submit()):(a(c).find(".mdjm-alert").show("fast"),a(c).find(".mdjm-alert").text(d.msg),d.field&&a("#"+d.field).addClass("error"),a(this).val(mdjm_vars.complete_payment),a(this).prop("disabled",!1))}}),mdjm_vars.availability_ajax&&a("#mdjm-availability-check").submit(function(b){if(!a("#availability_check_date").val())return!1;!!b.preventDefault&&b.preventDefault();var c=a("#availability_check_date").val(),d=mdjm_vars.rest_url;d+="availability/",d+="?date="+c,a.ajax({type:"GET",dataType:"json",url:d,beforeSend:function(){a('input[type="submit"]').hide(),a("#pleasewait").show()},success:function(b){var d=b.data.availability;"available"===d.response?("text"!==mdjm_vars.available_redirect?window.location.href=mdjm_vars.available_redirect+"mdjm_avail_date="+c:(a("#mdjm-availability-result").replaceWith('<div id="mdjm-availability-result">'+d.message+"</div>"),a("#mdjm-submit-availability").fadeTo("slow",1),a("#pleasewait").hide()),a('input[type="submit"]').prop("disabled",!1)):("text"!==mdjm_vars.unavailable_redirect?window.location.href=mdjm_vars.unavailable_redirect+"mdjm_avail_date="+c:(a("#mdjm-availability-result").replaceWith('<div id="mdjm-availability-result">'+d.message+"</div>"),a("#mdjm-submit-availability").fadeTo("slow",1),a("#pleasewait").hide()),a('input[type="submit"]').prop("disabled",!1))}})}),a("#mdjm-availability-check").validate({rules:{"mdjm-availability-datepicker":{required:!0}},messages:{"mdjm-availability-datepicker":{required:mdjm_vars.required_date_message}},errorClass:"mdjm_form_error",validClass:"mdjm_form_valid"})});